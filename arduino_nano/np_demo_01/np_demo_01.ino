#include <Adafruit_NeoPixel.h>

// -----------------------------------------------------------------------------
// ğŸ“Œ åƒæ•¸è¨­å®š (å·²æ›´æ–°ç‚º Arduino Nano D2 è…³ä½)
// -----------------------------------------------------------------------------

// Arduino Nano çš„ Digital Pin 2
#define PIN        2    
#define NUMPIXELS  20   // ç‡ˆæ¢ä¸Šçš„ç‡ˆç æ•¸é‡
#define DELAY_TIME 50   // æ¯é»äº®ä¸€é¡†ç‡ˆçš„å»¶é²æ™‚é–“ (æ¯«ç§’)

// å®£å‘Š Adafruit_NeoPixel ç‰©ä»¶
Adafruit_NeoPixel pixels(NUMPIXELS, PIN, NEO_GRB + NEO_KHZ800);

// -----------------------------------------------------------------------------
// âš™ï¸ setup() åˆå§‹è¨­å®š
// -----------------------------------------------------------------------------
void setup() {
  // å•Ÿå‹• Serial port for debugging (å¯é¸)
  Serial.begin(9600); 
  
  // å•Ÿå‹• Neopixel å‡½å¼åº«
  pixels.begin(); 
  
  // ç¢ºä¿æ‰€æœ‰ç‡ˆç åˆå§‹ç‹€æ…‹æ˜¯ç†„æ»…çš„
  pixels.clear(); 
  pixels.show();  
}

// -----------------------------------------------------------------------------
// ğŸ”„ loop() è¿´åœˆåŸ·è¡Œ
// -----------------------------------------------------------------------------
void loop() {
  // å‘¼å«æ¸¬è©¦å‡½æ•¸
  testPattern(); 

  // æ¸¬è©¦å®Œæˆå¾Œï¼Œç­‰å¾… 2 ç§’å†é‡æ–°åŸ·è¡Œ (å¯è‡ªè¡Œèª¿æ•´)
  delay(2000); 
}

// -----------------------------------------------------------------------------
// âœ¨ æ¸¬è©¦æ¨¡å¼ï¼šç¶ è‰²é€æ­¥é»äº®
// -----------------------------------------------------------------------------
void testPattern() {
  // ç‡ˆç é¡è‰²ï¼šç¶ è‰² (R=0, G=255, B=0)
  uint32_t green = pixels.Color(0, 25, 0); 
  
  // 1. é€æ­¥é»äº® (ç”±ç¬¬ 0 é¡†ç‡ˆåˆ°æœ€å¾Œä¸€é¡†ç‡ˆ)
  Serial.println("--- é€æ­¥é»äº® (ç¶ è‰²) ---");
  for(int i=0; i < NUMPIXELS; i++) { 
    // è¨­å®šç¬¬ i é¡†ç‡ˆçš„é¡è‰²
    pixels.setPixelColor(i, green);
    
    // ç«‹å³æ›´æ–°ç‡ˆæ¢é¡¯ç¤º
    pixels.show();  
    
    // å»¶é²ä¸€æ®µæ™‚é–“
    delay(DELAY_TIME);
  }

  // 2. å…¨éƒ¨é»äº®å®Œæˆå¾Œï¼Œä¿æŒäº®è‘— 1 ç§’
  delay(1000);
  
  // 3. å…¨éƒ¨ç†„æ»…
  Serial.println("--- å…¨éƒ¨ç†„æ»… ---");
  pixels.clear(); // å°‡ç·©è¡å€æ‰€æœ‰é¡è‰²è¨­ç‚ºé»‘è‰²
  pixels.show();  // å¯¦éš›æ›´æ–°ç‡ˆæ¢

  // ç†„æ»…å¾Œä¿æŒ 1 ç§’
  delay(1000);
}
